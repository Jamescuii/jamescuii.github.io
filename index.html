import React, { useState, useEffect } from 'react';

// ------ ICONS ------
// Using inline SVGs for icons to keep it self-contained
const SunIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
  </svg>
);

const MoonIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
  </svg>
);

const MenuIcon = () => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16m-7 6h7" />
    </svg>
);

const EmailIcon = () => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>
);

const GithubIcon = () => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-8 w-8" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
);

const LinkedinIcon = () => (
    <svg xmlns="http://www.w3.org/2000/svg" className="h-8 w-8" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
);


// ------ THEME TOGGLE COMPONENT ------
const ThemeToggle = ({ theme, setTheme }) => {
  const toggleTheme = () => {
    setTheme(theme === 'dark' ? 'light' : 'dark');
  };

  return (
    <button
      onClick={toggleTheme}
      className="p-2 rounded-full text-gray-400 dark:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none transition-colors"
    >
      {theme === 'dark' ? <SunIcon /> : <MoonIcon />}
    </button>
  );
};

// ------ HEADER COMPONENT ------
const Header = ({ theme, setTheme }) => {
    const [isMenuOpen, setIsMenuOpen] = useState(false);
    
    return (
        <header className="fixed top-0 left-0 right-0 z-50 bg-white/80 dark:bg-black/50 backdrop-blur-sm">
            <div className="container mx-auto px-6 py-4 flex justify-between items-center">
                <a href="#" className="text-xl font-bold text-gray-900 dark:text-white">James Cui</a>
                <nav className="hidden md:flex items-center space-x-8">
                    <a href="#about" className="text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400 transition-colors">About</a>
                    <a href="#skills" className="text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400 transition-colors">Skills</a>
                    <a href="#projects" className="text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400 transition-colors">Projects</a>
                    <a href="#experience" className="text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400 transition-colors">Experience</a>
                    <a href="#contact" className="text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400 transition-colors">Contact</a>
                    <ThemeToggle theme={theme} setTheme={setTheme} />
                </nav>
                <div className="md:hidden flex items-center">
                    <ThemeToggle theme={theme} setTheme={setTheme} />
                    <button onClick={() => setIsMenuOpen(!isMenuOpen)} className="ml-4 text-gray-800 dark:text-white">
                        <MenuIcon />
                    </button>
                </div>
            </div>
            {/* Mobile Menu */}
            {isMenuOpen && (
                <div className="md:hidden px-6 pb-4">
                    <a href="#about" className="block py-2 text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400">About</a>
                    <a href="#skills" className="block py-2 text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400">Skills</a>
                    <a href="#projects" className="block py-2 text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400">Projects</a>
                    <a href="#experience" className="block py-2 text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400">Experience</a>
                    <a href="#contact" className="block py-2 text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400">Contact</a>
                </div>
            )}
        </header>
    );
};

// ------ HERO SECTION ------
const Hero = () => (
    <section id="hero" className="min-h-screen flex flex-col justify-center items-start text-left">
        <h1 className="text-5xl md:text-7xl font-bold text-gray-900 dark:text-white leading-tight">James Cui</h1>
        <h2 className="text-2xl md:text-3xl font-medium text-gray-600 dark:text-gray-400 mt-2">Computer Science Student @ UW-Madison</h2>
        <p className="max-w-2xl mt-6 text-lg text-gray-700 dark:text-gray-400">
            Aspiring Software Engineer with a passion for machine learning, distributed systems, and building impactful technology. Currently exploring the frontiers of AI and cloud-native development.
        </p>
        <div className="mt-8 flex space-x-4">
            <a href="#projects" className="bg-cyan-500 text-white font-semibold px-6 py-3 rounded-md hover:bg-cyan-600 transition-transform transform hover:scale-105">View My Work</a>
            <a href="mailto:jamescui626@gmail.com" className="border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-white font-semibold px-6 py-3 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-all">Get In Touch</a>
        </div>
    </section>
);

// ------ ABOUT SECTION ------
const About = () => (
    <section id="about" className="py-20">
        <h2 className="text-4xl font-bold text-gray-900 dark:text-white text-center mb-12">About Me</h2>
        <div className="glass-card-light dark:glass-card-dark rounded-xl p-8 md:p-12 max-w-4xl mx-auto">
            <p className="text-lg leading-relaxed text-gray-700 dark:text-gray-300">
                I am a dedicated Computer Science student at the University of Wisconsin-Madison with a GPA of 3.93. My coursework in Advanced Algorithms, Software Engineering, and Deep Learning has provided me with a strong theoretical foundation, which I love to apply to practical, real-world problems.
            </p>
            <p className="text-lg leading-relaxed mt-4 text-gray-700 dark:text-gray-300">
                From developing machine translation systems with PyTorch to engineering full-stack inventory applications, I am driven by the challenge of creating efficient, scalable, and intelligent software. My experience as a Peer Mentor and Research Assistant has honed my collaboration and communication skills, and I thrive in team-based environments where I can both learn from and contribute to the collective goal.
            </p>
        </div>
    </section>
);

// ------ SKILLS SECTION ------
const Skills = () => (
    <section id="skills" className="py-20">
        <h2 className="text-4xl font-bold text-gray-900 dark:text-white text-center mb-12">Technical Skills</h2>
        <div className="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8">
            {/* Languages */}
            <div className="glass-card-light dark:glass-card-dark rounded-xl p-6">
                <h3 className="text-2xl font-semibold text-gray-900 dark:text-white mb-4">Languages</h3>
                <div className="flex flex-wrap gap-2">
                    {['Python', 'Java', 'C/C++', 'SQL', 'JavaScript', 'TypeScript', 'Go', 'Bash'].map(skill => (
                        <span key={skill} className="bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-300 px-3 py-1 rounded-full text-sm">{skill}</span>
                    ))}
                </div>
            </div>
            {/* Frameworks & Libraries */}
            <div className="glass-card-light dark:glass-card-dark rounded-xl p-6">
                <h3 className="text-2xl font-semibold text-gray-900 dark:text-white mb-4">Frameworks & Libraries</h3>
                <div className="flex flex-wrap gap-2">
                    {['PyTorch', 'TensorFlow', 'Spring Boot', 'React', 'Node.js', 'NumPy', 'Pandas', 'JUnit'].map(skill => (
                        <span key={skill} className="bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-300 px-3 py-1 rounded-full text-sm">{skill}</span>
                    ))}
                </div>
            </div>
            {/* Tools & Methodologies */}
            <div className="glass-card-light dark:glass-card-dark rounded-xl p-6">
                <h3 className="text-2xl font-semibold text-gray-900 dark:text-white mb-4">Tools & Methodologies</h3>
                <div className="flex flex-wrap gap-2">
                    {['Docker', 'Git', 'Linux/Unix', 'AWS', 'Google Cloud', 'Agile/Scrum', 'CI/CD', 'RESTful APIs'].map(skill => (
                        <span key={skill} className="bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-300 px-3 py-1 rounded-full text-sm">{skill}</span>
                    ))}
                </div>
            </div>
        </div>
    </section>
);

// ------ PROJECTS SECTION ------
const Projects = () => (
    <section id="projects" className="py-20">
        <h2 className="text-4xl font-bold text-gray-900 dark:text-white text-center mb-12">Projects</h2>
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8">
            {/* Project Cards Data */}
            {[
                { title: 'Neural Machine Translator', description: 'Engineered a sequence-to-sequence translation system by fine-tuning a BART (Transformer) model, achieving a 4x improvement in BLEU score over baseline.', tags: ['Python', 'PyTorch', 'Transformers', 'NLTK'], link: '#' },
                { title: 'FCOS Object Detection', description: 'Implemented a Fully Convolutional One-Stage (FCOS) object detector from scratch, reaching 37.2% mAP on the PASCAL VOC validation dataset.', tags: ['PyTorch', 'RegNet', 'FPN', 'CUDA'], link: '#' },
                { title: 'Smart Stock Inventory System', description: 'Led backend development for a full-stack retail/warehouse inventory system, featuring secure login and role-based access. Containerized the full application for consistent deployment.', tags: ['Java', 'Spring Boot', 'Docker', 'React', 'SQL'], link: '#' },
                { title: 'Music Player Library', description: 'Led a team of 4 to create a custom data structure in Java to parse, sort, and visualize CSV data as a music playlist, ensuring quality with robust JUnit testing.', tags: ['Java', 'JSON', 'Data Structures', 'JUnit'], link: '#' }
            ].map(project => (
                <div key={project.title} className="glass-card-light dark:glass-card-dark rounded-xl p-6 flex flex-col h-full">
                    <h3 className="text-2xl font-semibold text-gray-900 dark:text-white mb-2">{project.title}</h3>
                    <p className="text-gray-600 dark:text-gray-400 mb-4 flex-grow">{project.description}</p>
                    <div className="flex flex-wrap gap-2 mb-4">
                        {project.tags.map(tag => <span key={tag} className="bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-300 px-3 py-1 rounded-full text-sm">{tag}</span>)}
                    </div>
                    <a href={project.link} className="text-cyan-500 dark:text-cyan-400 font-semibold hover:underline mt-auto">View Code &rarr;</a>
                </div>
            ))}
        </div>
    </section>
);

// ------ EXPERIENCE SECTION ------
const Experience = () => (
    <section id="experience" className="py-20">
        <h2 className="text-4xl font-bold text-gray-900 dark:text-white text-center mb-12">Experience</h2>
        <div className="max-w-4xl mx-auto space-y-8">
            <div className="glass-card-light dark:glass-card-dark rounded-xl p-8">
                <div className="flex justify-between items-start">
                    <div>
                        <h3 className="text-xl font-bold text-gray-900 dark:text-white">CS 506 (Software Engineering) Peer Mentor</h3>
                        <p className="text-cyan-500 dark:text-cyan-400">University of Wisconsin-Madison</p>
                    </div>
                    <p className="text-gray-500 dark:text-gray-400 text-sm">Jan 2025 - May 2025</p>
                </div>
                <ul className="list-disc list-inside mt-4 text-gray-600 dark:text-gray-400 space-y-2">
                    <li>Co-led weekly tutorials for 200+ students on Agile, Maven, testing tools, and deployment workflows.</li>
                    <li>Mentored 20+ students one-on-one on Git, Scrum processes, and Docker setup.</li>
                </ul>
            </div>
            <div className="glass-card-light dark:glass-card-dark rounded-xl p-8">
                <div className="flex justify-between items-start">
                    <div>
                        <h3 className="text-xl font-bold text-gray-900 dark:text-white">Computer Vision Research Assistant</h3>
                        <p className="text-cyan-500 dark:text-cyan-400">MadAbility Research Group</p>
                    </div>
                    <p className="text-gray-500 dark:text-gray-400 text-sm">Jun 2024 - May 2025</p>
                </div>
                <ul className="list-disc list-inside mt-4 text-gray-600 dark:text-gray-400 space-y-2">
                    <li>Annotated 1,000+ images and trained a YOLO model in PyTorch with 15% higher accuracy than baseline.</li>
                    <li>Developed Unity C# AR barriers that improved OCD zone avoidance success rates by 60%.</li>
                </ul>
            </div>
        </div>
    </section>
);

// ------ FOOTER SECTION ------
const Footer = () => (
    <footer id="contact" className="border-t border-gray-200 dark:border-gray-800 mt-20">
        <div className="container mx-auto px-6 py-12 text-center">
            <h2 className="text-3xl font-bold text-gray-900 dark:text-white mb-4">Get In Touch</h2>
            <p className="text-gray-600 dark:text-gray-400 mb-8 max-w-xl mx-auto">
                I'm currently seeking Software Engineering internship opportunities. If you have a role that you think would be a good fit, or if you just want to connect, please feel free to reach out!
            </p>
            <div className="flex justify-center space-x-6">
                <a href="mailto:jamescui626@gmail.com" className="text-gray-500 dark:text-gray-400 hover:text-cyan-500 dark:hover:text-cyan-400 transition-colors"><EmailIcon /></a>
                <a href="#" className="text-gray-500 dark:text-gray-400 hover:text-cyan-500 dark:hover:text-cyan-400 transition-colors"><GithubIcon /></a>
                <a href="#" className="text-gray-500 dark:text-gray-400 hover:text-cyan-500 dark:hover:text-cyan-400 transition-colors"><LinkedinIcon /></a>
            </div>
            <p className="text-gray-500 dark:text-gray-600 mt-12 text-sm">&copy; 2025 James Cui. Built with passion and code.</p>
        </div>
    </footer>
);


// ------ MAIN APP COMPONENT ------
export default function App() {
  // State to manage the theme. It now checks localStorage and system preference for the initial value.
  const [theme, setTheme] = useState(() => {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      return savedTheme;
    }
    // Check system preference if no theme is saved
    return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  });

  // Effect to update the class on the <html> element and save the theme to localStorage
  useEffect(() => {
    const root = window.document.documentElement;
    if (theme === 'dark') {
      root.classList.add('dark');
    } else {
      root.classList.remove('dark');
    }
    localStorage.setItem('theme', theme);
  }, [theme]);
  
  return (
    <div className="bg-white text-gray-800 dark:bg-black dark:text-gray-300 antialiased transition-colors duration-300">
      <div className="fixed inset-0 z-[-1] bg-white dark:bg-black bg-dot-gray-300 dark:bg-dot-gray-800"></div>
      
      <Header theme={theme} setTheme={setTheme} />
      
      <main className="container mx-auto px-6 pt-24">
        <Hero />
        <About />
        <Skills />
        <Projects />
        <Experience />
      </main>
      
      <Footer />
      
      {/* CRITICAL FOR DARK MODE:
        For the `dark:` classes (like `dark:bg-black`) to work, you MUST configure Tailwind CSS.
        If you are using a `tailwind.config.js` file, make sure it includes this line:
        
        module.exports = {
          darkMode: 'class', // This is the essential line
          // ... other configurations
        }

        Without this setting, Tailwind doesn't know how to apply the dark theme styles,
        which is why the background was staying white and the icons were not styled correctly in dark mode.
      */}
      <style>{`
        .dark .bg-dot-gray-800 {
            background-color: #0a0a0a;
            background-image: radial-gradient(#1a1a1a 1px, transparent 0);
            background-size: 20px 20px;
        }
        .bg-dot-gray-300 {
            background-color: #f9fafb;
            background-image: radial-gradient(#e5e7eb 1px, transparent 0);
            background-size: 20px 20px;
        }
        .glass-card-dark {
            background: rgba(26, 26, 26, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(45, 45, 45, 0.5);
        }
        .glass-card-light {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(229, 231, 235, 0.5);
        }
      `}</style>
    </div>
  );
}
